# ‚úÖ CHECKLIST DE IMPLEMENTACI√ìN - CENATE

## üìã Gu√≠a de Verificaci√≥n Paso a Paso

Usa este checklist para asegurar que todos los componentes est√©n correctamente instalados y funcionando.

---

## üóÑÔ∏è FASE 1: BASE DE DATOS

### Instalaci√≥n
- [ ] PostgreSQL 14+ est√° instalado y corriendo
- [ ] Base de datos `maestro_cenate` est√° creada
- [ ] Script SQL `03_sistema_login_completo.sql` est√° ejecutado sin errores

### Verificaci√≥n
```sql
-- Verificar tablas creadas
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
ORDER BY table_name;

-- Resultado esperado: 5 tablas
-- ‚úì dim_permisos
-- ‚úì dim_roles
-- ‚úì dim_usuarios
-- ‚úì roles_permisos
-- ‚úì usuarios_roles
```

- [ ] Las 5 tablas existen
- [ ] Usuario SUPERADMIN fue creado

```sql
-- Verificar SUPERADMIN
SELECT * FROM dim_usuarios WHERE name_user = 'superadmin';
```

- [ ] Usuario tiene ID, username, password encriptada
- [ ] Usuario est√° ACTIVO

```sql
-- Verificar roles
SELECT * FROM dim_roles ORDER BY id_rol;
```

- [ ] 5 Roles existen: SUPERADMIN, ADMIN, ESPECIALISTA, RADIOLOGO, USUARIO

```sql
-- Verificar permisos
SELECT COUNT(*) FROM dim_permisos;
```

- [ ] 18 Permisos existen

```sql
-- Verificar permisos del SUPERADMIN
SELECT DISTINCT p.desc_permiso
FROM dim_usuarios u
JOIN usuarios_roles ur ON u.id_user = ur.id_user
JOIN dim_roles r ON ur.id_rol = r.id_rol
JOIN roles_permisos rp ON r.id_rol = rp.id_rol
JOIN dim_permisos p ON rp.id_permiso = p.id_permiso
WHERE u.name_user = 'superadmin'
ORDER BY p.desc_permiso;
```

- [ ] SUPERADMIN tiene 18 permisos

---

## üîß FASE 2: BACKEND

### Configuraci√≥n
- [ ] Java 17+ est√° instalado

```bash
java -version
# Resultado esperado: java version "17.x.x" o superior
```

- [ ] Maven o Gradle est√° instalado

```bash
./mvnw -version
# o
./gradlew -version
```

- [ ] Archivo `application.properties` tiene las credenciales correctas

```bash
cat src/main/resources/application.properties
```

- [ ] URL de base de datos es correcta
- [ ] Usuario de base de datos es correcto
- [ ] Contrase√±a de base de datos es correcta

### Compilaci√≥n
```bash
cd backend
./mvnw clean package
```

- [ ] Compilaci√≥n exitosa sin errores
- [ ] Archivo JAR generado en `target/`

### Ejecuci√≥n
```bash
./mvnw spring-boot:run
```

- [ ] Backend inicia sin errores
- [ ] Ver en consola: "Started CenateApplication"
- [ ] Backend est√° escuchando en puerto 8080

### Verificaci√≥n de Endpoints

#### Health Check
```bash
curl http://localhost:8080/api/auth/health
```

- [ ] Respuesta: `{"status":"OK","service":"Authentication Service"}`

#### Login
```bash
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"superadmin","password":"SuperAdmin2024!"}'
```

- [ ] Respuesta c√≥digo 200
- [ ] Respuesta contiene `token`
- [ ] Respuesta contiene `username: "superadmin"`
- [ ] Respuesta contiene `roles: ["SUPERADMIN"]`
- [ ] Respuesta contiene array de `permisos`

**Guardar el token para siguientes pruebas:**
```bash
export TOKEN="tu_token_aqui"
```

#### Get Current User
```bash
curl http://localhost:8080/api/usuarios/me \
  -H "Authorization: Bearer $TOKEN"
```

- [ ] Respuesta c√≥digo 200
- [ ] Respuesta contiene informaci√≥n del usuario

#### Get All Users (Admin)
```bash
curl http://localhost:8080/api/usuarios \
  -H "Authorization: Bearer $TOKEN"
```

- [ ] Respuesta c√≥digo 200
- [ ] Respuesta contiene array de usuarios

### Test Automatizado
```bash
chmod +x test_api.sh
./test_api.sh
```

- [ ] 15/15 tests pasan (100%)
- [ ] No hay errores

---

## üé® FASE 3: FRONTEND

### Instalaci√≥n
- [ ] Node.js 16+ est√° instalado

```bash
node -version
# Resultado esperado: v16.x.x o superior
```

- [ ] npm est√° instalado

```bash
npm -version
```

### Setup del Proyecto

#### Opci√≥n A: Vite (Recomendado)
```bash
npm create vite@latest cenate-frontend -- --template react
cd cenate-frontend
npm install
npm install react-router-dom
```

- [ ] Proyecto creado sin errores
- [ ] Dependencias instaladas

#### Opci√≥n B: Create React App
```bash
npx create-react-app cenate-frontend
cd cenate-frontend
npm install react-router-dom
```

- [ ] Proyecto creado sin errores
- [ ] Dependencias instaladas

### Copiar Componentes
```bash
cp -r ../ejemplos/* src/
```

- [ ] Archivos copiados correctamente
- [ ] Verificar que `src/` tiene:
  - [ ] App.jsx
  - [ ] AuthContext.jsx
  - [ ] ProtectedRoute.jsx
  - [ ] LoginPanel.jsx + .css
  - [ ] Dashboard.jsx + .css
  - [ ] UsersAdmin.jsx + .css
  - [ ] ChangePassword.jsx + .css
  - [ ] Unauthorized.jsx + .css

### Configurar main.jsx (Vite) o index.js (CRA)

**Para Vite (src/main.jsx):**
```jsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
)
```

**Para CRA (src/index.js):**
```jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

- [ ] Archivo configurado correctamente

### Ejecuci√≥n
```bash
npm run dev  # Vite
# o
npm start    # CRA
```

- [ ] Frontend inicia sin errores
- [ ] Navegador se abre autom√°ticamente
- [ ] URL: http://localhost:3000 o http://localhost:5173

---

## üß™ FASE 4: TESTING FUNCIONAL

### Test 1: Login Exitoso
1. [ ] Abrir http://localhost:3000 (o 5173)
2. [ ] Se muestra el panel de login
3. [ ] Ingresar:
   - Username: `superadmin`
   - Password: `SuperAdmin2024!`
4. [ ] Click en "Iniciar Sesi√≥n"
5. [ ] Redirige a `/dashboard`
6. [ ] Se muestra el dashboard con:
   - [ ] Nombre de usuario en el header
   - [ ] Badge "SUPERADMIN"
   - [ ] Men√∫ lateral con todas las opciones
   - [ ] Tarjetas de acceso r√°pido

### Test 2: Login Fallido
1. [ ] Ir a http://localhost:3000/login
2. [ ] Ingresar credenciales incorrectas
3. [ ] Se muestra mensaje de error
4. [ ] NO redirige
5. [ ] NO hay token en localStorage

### Test 3: Protecci√≥n de Rutas
1. [ ] Cerrar sesi√≥n (bot√≥n en header)
2. [ ] Intentar acceder a http://localhost:3000/dashboard
3. [ ] Redirige autom√°ticamente a `/login`
4. [ ] Intentar acceder a http://localhost:3000/admin/usuarios
5. [ ] Redirige autom√°ticamente a `/login`

### Test 4: Men√∫ Din√°mico
1. [ ] Login como SUPERADMIN
2. [ ] Verificar que el men√∫ lateral muestra:
   - [ ] Aplicaciones (todas)
   - [ ] Administraci√≥n (Usuarios, Roles, Auditor√≠a)
   - [ ] Reportes
3. [ ] Todos los enlaces son accesibles

### Test 5: Gesti√≥n de Usuarios
1. [ ] Login como SUPERADMIN
2. [ ] Ir a "Administraci√≥n" > "Usuarios"
3. [ ] Se muestra la lista de usuarios
4. [ ] Click en "+ Crear Usuario"
5. [ ] Ingresar datos:
   ```
   Usuario: test_user
   Contrase√±a: Test2024!
   Roles: [USUARIO]
   Estado: ACTIVO
   ```
6. [ ] Click en "Crear Usuario"
7. [ ] Usuario aparece en la lista
8. [ ] Verificar acciones disponibles:
   - [ ] Desactivar (bot√≥n ‚è∏Ô∏è)
   - [ ] Eliminar (bot√≥n üóëÔ∏è) - solo SUPERADMIN

### Test 6: Cambio de Contrase√±a
1. [ ] Login como SUPERADMIN
2. [ ] Navegar a p√°gina de cambio de contrase√±a
3. [ ] Ingresar:
   - Contrase√±a actual: `SuperAdmin2024!`
   - Nueva contrase√±a: `NewPass2024!`
   - Confirmar: `NewPass2024!`
4. [ ] Se muestra indicador de fortaleza
5. [ ] Click en "Cambiar Contrase√±a"
6. [ ] Mensaje de √©xito
7. [ ] Cerrar sesi√≥n
8. [ ] Login con nueva contrase√±a
9. [ ] Login exitoso

### Test 7: Bloqueo por Intentos Fallidos
1. [ ] Cerrar sesi√≥n
2. [ ] Intentar login 5 veces con contrase√±a incorrecta
3. [ ] En el 5to intento: mensaje "Cuenta bloqueada"
4. [ ] Login con contrase√±a correcta falla
5. [ ] En backend, desbloquear manualmente:
```sql
UPDATE dim_usuarios 
SET failed_attempts = 0, locked_until = NULL 
WHERE name_user = 'superadmin';
```
6. [ ] Login con contrase√±a correcta funciona

### Test 8: Responsive Design
1. [ ] Abrir DevTools (F12)
2. [ ] Toggle device toolbar
3. [ ] Probar en diferentes tama√±os:
   - [ ] Mobile (320px)
   - [ ] Tablet (768px)
   - [ ] Desktop (1024px)
   - [ ] Large (1440px)
4. [ ] UI se adapta correctamente en todos los tama√±os

### Test 9: Crear Usuario con Diferentes Roles
1. [ ] Login como SUPERADMIN
2. [ ] Crear usuarios con diferentes roles:
   - [ ] Usuario ADMIN
   - [ ] Usuario ESPECIALISTA
   - [ ] Usuario RADIOLOGO
   - [ ] Usuario USUARIO b√°sico
3. [ ] Cerrar sesi√≥n
4. [ ] Login como cada usuario
5. [ ] Verificar que el men√∫ muestra solo las opciones permitidas

---

## üîí FASE 5: SEGURIDAD

### Verificaciones de Seguridad
- [ ] Contrase√±as est√°n encriptadas en BD (BCrypt)
- [ ] JWT tokens expiran (verificar despu√©s de 24h)
- [ ] CORS est√° configurado correctamente
- [ ] Endpoints protegidos requieren autenticaci√≥n
- [ ] Roles son verificados en backend
- [ ] No hay console.log con informaci√≥n sensible
- [ ] .env no est√° en Git (.gitignore)

### Pruebas de Seguridad

#### Test 1: Token Inv√°lido
```bash
curl http://localhost:8080/api/usuarios/me \
  -H "Authorization: Bearer token_invalido_123"
```
- [ ] Respuesta: 401 o 403

#### Test 2: Sin Token
```bash
curl http://localhost:8080/api/usuarios
```
- [ ] Respuesta: 401 o 403

#### Test 3: Usuario sin Permisos
1. [ ] Login como USUARIO b√°sico
2. [ ] Intentar acceder a `/admin/usuarios`
3. [ ] Redirige a `/unauthorized`

---

## üìö FASE 6: DOCUMENTACI√ìN

### Archivos Verificados
- [ ] README.md existe y est√° completo
- [ ] INSTALACION_COMPLETA.md existe
- [ ] RESUMEN_EJECUTIVO.md existe
- [ ] backend/SISTEMA_LOGIN_GUIA_COMPLETA.md existe
- [ ] frontend/ejemplos/README_FRONTEND.md existe

### Colecci√≥n de Postman
- [ ] Archivo .json existe
- [ ] Se puede importar en Postman
- [ ] Todos los requests funcionan

---

## üöÄ FASE 7: PREPARACI√ìN PARA PRODUCCI√ìN

### Backend
- [ ] Cambiar JWT_SECRET_KEY en producci√≥n
- [ ] Cambiar contrase√±a de BD
- [ ] Configurar HTTPS
- [ ] Configurar logging apropiado
- [ ] Configurar backup de BD
- [ ] Revisar CORS allowed origins

### Frontend
- [ ] Cambiar URL del backend (production)
- [ ] Build de producci√≥n funciona (`npm run build`)
- [ ] Assets optimizados
- [ ] Configurar servidor web (nginx)

### Infraestructura
- [ ] Firewall configurado
- [ ] SSL/TLS configurado
- [ ] Backup autom√°tico
- [ ] Monitoring configurado
- [ ] Logs centralizados

---

## ‚úÖ CHECKLIST FINAL

### Funcionalidades Core
- [ ] Login funciona
- [ ] Logout funciona
- [ ] Cambio de contrase√±a funciona
- [ ] Crear usuarios funciona
- [ ] Activar/Desactivar usuarios funciona
- [ ] Eliminar usuarios funciona (SUPERADMIN)
- [ ] Roles limitan acceso correctamente
- [ ] Men√∫ se adapta a permisos
- [ ] Bloqueo por intentos fallidos funciona

### Documentaci√≥n
- [ ] README principal completo
- [ ] Documentaci√≥n de instalaci√≥n completa
- [ ] Documentaci√≥n de API completa
- [ ] Ejemplos de c√≥digo incluidos
- [ ] Colecci√≥n de Postman disponible

### Testing
- [ ] Tests automatizados pasan (15/15)
- [ ] Tests manuales completados
- [ ] Pruebas de seguridad pasadas
- [ ] Pruebas responsive completadas

### Producci√≥n (Opcional)
- [ ] Variables de entorno configuradas
- [ ] Credenciales por defecto cambiadas
- [ ] HTTPS configurado
- [ ] Logs configurados
- [ ] Backup configurado
- [ ] Monitoring configurado

---

## üéâ COMPLETADO

Si todos los items est√°n marcados, el sistema est√° completamente funcional y listo para usar.

**¬°Felicidades! Tu sistema de autenticaci√≥n CENATE est√° operativo.** üöÄ

---

## üìù NOTAS

- Fecha de completaci√≥n: ______________
- Versi√≥n instalada: 1.0.0
- Instalado por: ______________
- Problemas encontrados: ______________
- Soluciones aplicadas: ______________

---

**Para soporte, consultar:**
- INSTALACION_COMPLETA.md
- SISTEMA_LOGIN_GUIA_COMPLETA.md
- README_FRONTEND.md
