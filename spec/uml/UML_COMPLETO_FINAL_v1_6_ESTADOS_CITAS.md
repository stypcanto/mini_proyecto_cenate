# ğŸ“Š UML COMPLETO Y ACTUALIZADO v1.6.0 - MÃ“DULO SOLICITUDES DE BOLSA CON ESTADOS CITAS

> **CAMBIO PRINCIPAL v1.6.0:** El campo `estado` ahora utiliza valores de `dim_estados_gestion_citas`. Inicialmente: **PENDIENTE_CITA**

---

## ğŸ¯ ARQUITECTURA GENERAL

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUJO DE DATOS - CARGA DE SOLICITUDES                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  FRONTEND SELECCIONES          EXCEL (Usuario)         BACKEND VALIDA   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PASO 1:          â”‚         â”‚ Campos:     â”‚         â”‚ Validaciones:â”‚ â”‚
â”‚  â”‚ TIPO BOLSA       â”‚         â”‚ â€¢ DNI       â”‚         â”‚ â€¢ DNI en     â”‚ â”‚
â”‚  â”‚ (selector)       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”œâ”€ Obligatorioâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   asegurados â”‚ â”‚
â”‚  â”‚ dim_tipos_bolsas â”‚         â”‚             â”‚         â”‚ â€¢ IPRESS en  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â€¢ CÃ³digo    â”‚         â”‚   dim_ipress â”‚ â”‚
â”‚           â”‚                   â”‚   Adscripc. â”‚         â”‚ â€¢ Sin        â”‚ â”‚
â”‚           â”‚                   â”‚ - Obligatorio         â”‚   duplicados â”‚ â”‚
â”‚           â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                                                  â”‚          â”‚
â”‚           â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚          â”‚
â”‚           â”‚                   â”‚ PASO 2:          â”‚          â”‚          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ ESPECIALIDAD     â”‚          â”‚          â”‚
â”‚                               â”‚ (selector)       â”‚          â”‚          â”‚
â”‚                               â”‚ dim_servicio_essiâ”‚          â”‚          â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚          â”‚
â”‚                                        â”‚                    â”‚          â”‚
â”‚                                        â–¼ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â”‚                           âœ… TODAS LAS VALIDACIONES OK                 â”‚
â”‚                                        â”‚                               â”‚
â”‚                                        â–¼                               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚  INSERTAR EN dim_solicitud_bolsa (Tabla Central)    â”‚        â”‚
â”‚         â”‚  âœ… COMBINACIÃ“N DE TODOS LOS DATOS                 â”‚        â”‚
â”‚         â”‚                                                    â”‚        â”‚
â”‚         â”‚  â€¢ De Excel: DNI, CÃ³digo AdscripciÃ³n             â”‚        â”‚
â”‚         â”‚  â€¢ De Selector: TIPO BOLSA, ESPECIALIDAD         â”‚        â”‚
â”‚         â”‚  â€¢ Auto-obtenidos: Nombres, IPRESS, Red, etc.    â”‚        â”‚
â”‚         â”‚  â€¢ Auto-asignados: Estado PENDIENTE_CITA, Usuarioâ”‚        â”‚
â”‚         â”‚  â€¢ Auto-generados: ID, NÃºmero, Fechas            â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                        â”‚                               â”‚
â”‚                                        â–¼                               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚    VISUALIZAR EN TABLA (MÃ³dulo Bolsas)             â”‚        â”‚
â”‚         â”‚    Todos los datos combinados listos para          â”‚        â”‚
â”‚         â”‚    asignar gestor de citas                         â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ TABLAS DE REFERENCIA (Originales - No modificadas)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        dim_tipos_bolsas                  â”‚ â—„â”€â”€â”€ FUENTE PASO 1
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK: id_tipo_bolsa (BIGSERIAL)            â”‚
â”‚                                          â”‚
â”‚ â€¢ cod_tipo_bolsa (VARCHAR, UNIQUE)       â”‚
â”‚ â€¢ desc_tipo_bolsa (TEXT)                 â”‚
â”‚ â€¢ stat_tipo_bolsa (CHAR: 'A' | 'I')      â”‚
â”‚ â€¢ created_at (TIMESTAMP)                 â”‚
â”‚ â€¢ updated_at (TIMESTAMP)                 â”‚
â”‚                                          â”‚
â”‚ â”Œâ”€ Datos iniciales (7 tipos) â”€â”€â”        â”‚
â”‚ â”‚ 1. BOLSA_107                  â”‚        â”‚
â”‚ â”‚ 2. BOLSA_DENGUE               â”‚        â”‚
â”‚ â”‚ 3. BOLSAS_ENFERMERIA          â”‚        â”‚
â”‚ â”‚ 4. BOLSAS_EXPLOTADATOS        â”‚        â”‚
â”‚ â”‚ 5. BOLSAS_IVR                 â”‚        â”‚
â”‚ â”‚ 6. BOLSAS_REPROGRAMACION      â”‚        â”‚
â”‚ â”‚ 7. BOLSA_GESTORES_TERRITORIAL â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      dim_servicio_essi                   â”‚ â—„â”€â”€â”€ FUENTE PASO 2
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK: id_servicio (BIGSERIAL)              â”‚
â”‚                                          â”‚
â”‚ â€¢ cod_servicio (VARCHAR 10)              â”‚
â”‚ â€¢ desc_servicio (TEXT)                   â”‚
â”‚ â€¢ es_cenate (BOOLEAN)                    â”‚
â”‚ â€¢ estado (CHAR: 'A' | 'I')               â”‚
â”‚ â€¢ created_at (TIMESTAMP)                 â”‚
â”‚ â€¢ updated_at (TIMESTAMP)                 â”‚
â”‚                                          â”‚
â”‚ Ejemplos:                                â”‚
â”‚ â€¢ CardiologÃ­a (cÃ³digo: 001)              â”‚
â”‚ â€¢ NeurologÃ­a (cÃ³digo: 002)               â”‚
â”‚ â€¢ OncologÃ­a (cÃ³digo: 003)                â”‚
â”‚ â€¢ ... mÃ¡s especialidades                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          dim_ipress                      â”‚ â—„â”€â”€â”€ FUENTE VALIDACIÃ“N EXCEL
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK: id_ipress (BIGSERIAL)                â”‚
â”‚                                          â”‚
â”‚ â€¢ cod_ipress (VARCHAR)  â—„â”€â”€â”€ COINCIDE   â”‚
â”‚                             con Excel    â”‚
â”‚ â€¢ desc_ipress (VARCHAR)  Ej: "349"      â”‚
â”‚ â€¢ id_red (FK â†’ dim_red)                  â”‚
â”‚ â€¢ direc_ipress (VARCHAR)                 â”‚
â”‚ â€¢ id_tip_ipress (FK)                     â”‚
â”‚ â€¢ id_niv_aten (FK)                       â”‚
â”‚ â€¢ stat_ipress (CHAR: 'A' | 'I')          â”‚
â”‚                                          â”‚
â”‚ Ejemplo:                                 â”‚
â”‚ â€¢ cod_ipress: "349"                      â”‚
â”‚ â€¢ desc_ipress: "H.II PUCALLPA"           â”‚
â”‚ â€¢ id_red: 5                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ id_red
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            dim_red                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK: id_red (BIGSERIAL)                   â”‚
â”‚                                          â”‚
â”‚ â€¢ cod_red (TEXT)                         â”‚
â”‚ â€¢ desc_red (TEXT)                        â”‚
â”‚ â€¢ id_macro (FK)                          â”‚
â”‚                                          â”‚
â”‚ Ejemplo:                                 â”‚
â”‚ â€¢ desc_red: "RED ASISTENCIAL UCAYALI"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       asegurados                         â”‚ â—„â”€â”€â”€ FUENTE VALIDACIÃ“N EXCEL
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK: pk_asegurado (INTEGER)               â”‚
â”‚                                          â”‚
â”‚ â€¢ doc_paciente (VARCHAR) â—„â”€â”€â”€ COINCIDE  â”‚
â”‚                              con Excel   â”‚
â”‚ â€¢ paciente (VARCHAR) Ej: "12345678"     â”‚
â”‚ â€¢ tel_fijo (VARCHAR)                     â”‚
â”‚ â€¢ tel_celular (VARCHAR)                  â”‚
â”‚ â€¢ correo_electronico (VARCHAR)           â”‚
â”‚ â€¢ cas_adscripcion (VARCHAR)              â”‚
â”‚ â€¢ ... otros campos                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  dim_estados_gestion_citas               â”‚ â—„â”€â”€â”€ FUENTE ESTADO INICIAL
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   (v1.33.0)
â”‚ PK: id_estado_cita (BIGSERIAL)           â”‚
â”‚                                          â”‚
â”‚ â€¢ cod_estado_cita (TEXT)                 â”‚
â”‚ â€¢ desc_estado_cita (TEXT)                â”‚
â”‚ â€¢ stat_estado_cita (CHAR: 'A' | 'I')     â”‚
â”‚                                          â”‚
â”‚ Estados iniciales (10):                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ 1. CITADO (visitÃ³, asistiÃ³)         â”‚  â”‚
â”‚ â”‚ 2. NO_CONTESTA (no responde)        â”‚  â”‚
â”‚ â”‚ 3. CANCELADO (cita cancelada)       â”‚  â”‚
â”‚ â”‚ 4. ASISTIO (asistiÃ³ a la cita)      â”‚  â”‚
â”‚ â”‚ 5. PENDIENTE_CITA â—„â”€â”€â”€ INICIAL      â”‚  â”‚
â”‚ â”‚ 6. REPROGRAMADO (reprogramada)      â”‚  â”‚
â”‚ â”‚ 7. INASISTENCIA (no asistiÃ³)        â”‚  â”‚
â”‚ â”‚ 8. VENCIDO (plazo vencido)          â”‚  â”‚
â”‚ â”‚ 9. EN_SEGUIMIENTO (seguimiento)     â”‚  â”‚
â”‚ â”‚ 10. DERIVADO (derivada a otro)      â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         dim_usuarios                     â”‚ â—„â”€â”€â”€ REFERENCIA AUDITORÃA
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK: id_user (BIGSERIAL)                  â”‚
â”‚                                          â”‚
â”‚ â€¢ name_user (VARCHAR)                    â”‚
â”‚ â€¢ pass_user (VARCHAR)                    â”‚
â”‚ â€¢ stat_user (VARCHAR)                    â”‚
â”‚ â€¢ ... otros campos                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUJO DETALLADO DE DATOS (CÃ³mo se obtiene cada campo)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ORIGEN Y COMBINACIÃ“N DE DATOS                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚ ENTRADA 1: SELECTOR PASO 1 (TIPO BOLSA)                                  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚ Usuario selecciona: id_tipo_bolsa (ej: 1 = BOLSA_107)                    â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º id_tipo_bolsa = 1                                           â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º cod_tipo_bolsa = "BOLSA_107" (de dim_tipos_bolsas)          â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â–º desc_tipo_bolsa = "Bolsa 107 - ImportaciÃ³n masiva"          â”‚
â”‚                                (de dim_tipos_bolsas)                     â”‚
â”‚                                                                           â”‚
â”‚ ENTRADA 2: SELECTOR PASO 2 (ESPECIALIDAD)                                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Usuario selecciona: id_servicio (ej: 1 = CardiologÃ­a)                    â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º id_servicio = 1                                             â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º especialidad = "CardiologÃ­a" (de dim_servicio_essi)          â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â–º cod_servicio = "001" (de dim_servicio_essi)                 â”‚
â”‚                                                                           â”‚
â”‚ ENTRADA 3: EXCEL (USUARIO PROPORCIONA - OBLIGATORIOS)                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Fila 1: DNI="12345678" | CÃ³digo AdscripciÃ³n="349"                        â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€ DNI (12345678)                                               â”‚
â”‚          â”‚     â”‚                                                         â”‚
â”‚          â”‚     â–¼ Busca en asegurados.doc_paciente                        â”‚
â”‚          â”‚     â”‚                                                         â”‚
â”‚          â”‚     â”œâ”€â–º paciente_dni = "12345678"                             â”‚
â”‚          â”‚     â”‚                                                         â”‚
â”‚          â”‚     â”œâ”€â–º paciente_id = 456 (pk_asegurado)                      â”‚
â”‚          â”‚     â”‚                                                         â”‚
â”‚          â”‚     â””â”€â–º paciente_nombre = "Juan PÃ©rez GarcÃ­a"                 â”‚
â”‚          â”‚         (de asegurados.paciente)                              â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€ CÃ³digo AdscripciÃ³n ("349")                                   â”‚
â”‚                â”‚                                                         â”‚
â”‚                â–¼ Busca en dim_ipress.cod_ipress                          â”‚
â”‚                â”‚                                                         â”‚
â”‚                â”œâ”€â–º codigo_adscripcion = "349"                            â”‚
â”‚                â”‚                                                         â”‚
â”‚                â”œâ”€â–º id_ipress = 5 (pk de dim_ipress)                      â”‚
â”‚                â”‚                                                         â”‚
â”‚                â”œâ”€â–º nombre_ipress = "H.II PUCALLPA"                       â”‚
â”‚                â”‚   (de dim_ipress.desc_ipress)                           â”‚
â”‚                â”‚                                                         â”‚
â”‚                â”œâ”€â–º id_red = 5 (de dim_ipress.id_red)                     â”‚
â”‚                â”‚                                                         â”‚
â”‚                â””â”€â–º red_asistencial = "RED ASISTENCIAL UCAYALI"           â”‚
â”‚                    (de dim_red.desc_red vÃ­a id_red)                      â”‚
â”‚                                                                           â”‚
â”‚ ENTRADA 4: CONTEXTO (SISTEMA AUTOMÃTICO)                                 â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Usuario actualmente logueado en el sistema:                              â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º solicitante_id = 1 (usuario actual)                         â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â–º solicitante_nombre = "Carlos Admin"                         â”‚
â”‚              (de dim_usuarios.name_user)                                 â”‚
â”‚                                                                           â”‚
â”‚ ENTRADA 5: ESTADO INICIAL (DE dim_estados_gestion_citas) â—„â”€â”€â”€ NUEVO      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ Sistema asigna automÃ¡ticamente el estado inicial:                        â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º estado_gestion_citas_id = 5 (id de PENDIENTE_CITA)           â”‚
â”‚          â”‚   (BÃºsqueda: WHERE cod_estado_cita = 'PENDIENTE_CITA')        â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º desc_estado_cita = "Pendiente de Cita"                      â”‚
â”‚          â”‚   (De dim_estados_gestion_citas.desc_estado_cita)             â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â–º cod_estado_cita = "PENDIENTE_CITA"                          â”‚
â”‚              (De dim_estados_gestion_citas.cod_estado_cita)              â”‚
â”‚                                                                           â”‚
â”‚ ENTRADA 6: GENERACIÃ“N AUTOMÃTICA (BACKEND)                               â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ El sistema genera/asigna automÃ¡ticamente:                                â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º id_solicitud = 1 (BIGSERIAL auto-increment)                 â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º numero_solicitud = "BOLSA-20260123-00001"                   â”‚
â”‚          â”‚   (Formato: BOLSA-YYYYMMDD-XXXXX)                             â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º fecha_solicitud = 2026-01-23 10:30:00                       â”‚
â”‚          â”‚   (CURRENT_TIMESTAMP automÃ¡tico)                              â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º fecha_actualizacion = 2026-01-23 10:30:00                   â”‚
â”‚          â”‚   (igual a fecha_solicitud inicialmente)                      â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â–º activo = true (por defecto)                                 â”‚
â”‚                                                                           â”‚
â”‚ CAMPOS INICIALMENTE VACÃOS (Se asignan despuÃ©s):                          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º responsable_gestora_id = NULL                               â”‚
â”‚          â”‚   (Se asignarÃ¡ cuando un gestor se responsabilice)            â”‚
â”‚          â”‚                                                               â”‚
â”‚          â”œâ”€â–º fecha_asignacion = NULL                                     â”‚
â”‚          â”‚   (Se registrarÃ¡ cuando se asigne el gestor)                  â”‚
â”‚          â”‚                                                               â”‚
â”‚          â””â”€â–º recordatorio_enviado = false                                â”‚
â”‚              (Se actualizarÃ¡ cuando se envÃ­e recordatorio)               â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š TABLA CENTRAL: dim_solicitud_bolsa (26 CAMPOS - ACTUALIZADA v1.6.0)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘           dim_solicitud_bolsa - TABLA CENTRAL COMBINADA v1.6.0             â•‘
â•‘                                                                            â•‘
â•‘    Combina datos de: Excel + Selectores + Validaciones + dim_estados...   â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ”‘ IDENTIFICACIÃ“N (Auto-generada)                                          â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  id_solicitud         â”‚ BIGSERIAL (PK)       â”‚ 1, 2, 3, ...               â”ƒ
â”ƒ  numero_solicitud     â”‚ VARCHAR(50), UNQ     â”‚ BOLSA-20260123-00001       â”ƒ
â”ƒ                       â”‚                      â”‚ Generado: BOLSA-YYYYMMDD-IDâ”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ“¦ TIPO DE BOLSA (De: Selector PASO 1 + dim_tipos_bolsas)                 â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  id_tipo_bolsa        â”‚ BIGINT, FK, NOT NULL â”‚ 1                          â”ƒ
â”ƒ                       â”‚ â†’ dim_tipos_bolsas   â”‚ (Usuario selecciona)       â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚                            â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  cod_tipo_bolsa       â”‚ TEXT                 â”‚ BOLSA_107                  â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de FK)      â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  desc_tipo_bolsa      â”‚ TEXT                 â”‚ Bolsa 107 - ImportaciÃ³n    â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de FK)      â”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ¥ ESPECIALIDAD (De: Selector PASO 2 + dim_servicio_essi)                 â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  id_servicio          â”‚ BIGINT, FK, NOT NULL â”‚ 1                          â”ƒ
â”ƒ                       â”‚ â†’ dim_servicio_essi  â”‚ (Usuario selecciona)       â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚                            â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  especialidad         â”‚ VARCHAR(255)         â”‚ CardiologÃ­a                â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de FK)      â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  cod_servicio         â”‚ VARCHAR(10)          â”‚ 001                        â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de FK)      â”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ‘¤ DATOS PACIENTE (De: Excel + ValidaciÃ³n en asegurados)                  â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  paciente_dni         â”‚ VARCHAR(20), NOT NULLâ”‚ 12345678                   â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚ (Usuario proporciona Excel)â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  paciente_id          â”‚ BIGINT, FK, NOT NULL â”‚ 456                        â”ƒ
â”ƒ                       â”‚ â†’ asegurados.pk_     â”‚ (Auto-obtenido validando  â”ƒ
â”ƒ                       â”‚ asegurado            â”‚  DNI en asegurados)        â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚                            â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  paciente_nombre      â”‚ VARCHAR(255), NOT NULâ”‚ Juan PÃ©rez GarcÃ­a          â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de         â”ƒ
â”ƒ                       â”‚                      â”‚  asegurados.paciente)      â”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ¥ INFORMACIÃ“N IPRESS (De: Excel + ValidaciÃ³n en dim_ipress + dim_red)    â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  codigo_adscripcion   â”‚ VARCHAR(20), NOT NULLâ”‚ 349                        â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚ (Usuario proporciona Excel)â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  id_ipress            â”‚ BIGINT, FK          â”‚ 5                          â”ƒ
â”ƒ                       â”‚ â†’ dim_ipress        â”‚ (Auto-obtenido validando  â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚  cÃ³digo_adscripciÃ³n)       â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  nombre_ipress        â”‚ VARCHAR(255)        â”‚ H.II PUCALLPA              â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de         â”ƒ
â”ƒ                       â”‚                      â”‚  dim_ipress.desc_ipress)   â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  red_asistencial      â”‚ VARCHAR(255)        â”‚ RED ASISTENCIAL UCAYALI    â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de         â”ƒ
â”ƒ                       â”‚                      â”‚  dim_red.desc_red vÃ­a      â”ƒ
â”ƒ                       â”‚                      â”‚  dim_ipress.id_red)        â”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ“Š ESTADO Y SOLICITANTE (Auto-asignados)                                  â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  estado_gestion_citas â”‚ BIGINT, FK, NOT NULL â”‚ 5                          â”ƒ
â”ƒ  _id                  â”‚ â†’ dim_estados_       â”‚ (Sistema asigna            â”ƒ
â”ƒ                       â”‚ gestion_citas        â”‚  PENDIENTE_CITA)           â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚ Inicialmente buscado por:  â”ƒ
â”ƒ                       â”‚ Default: 5          â”‚ cod_estado_cita =          â”ƒ
â”ƒ                       â”‚ (PENDIENTE_CITA)    â”‚ 'PENDIENTE_CITA'           â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  cod_estado_cita      â”‚ TEXT                 â”‚ PENDIENTE_CITA             â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de FK)      â”ƒ
â”ƒ                       â”‚                      â”‚ Valores posibles:          â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ PENDIENTE_CITA â—„â”€ INIT  â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ CITADO                   â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ NO_CONTESTA              â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ CANCELADO                â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ ASISTIO                  â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ REPROGRAMADO             â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ INASISTENCIA             â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ VENCIDO                  â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ EN_SEGUIMIENTO           â”ƒ
â”ƒ                       â”‚                      â”‚ â€¢ DERIVADO                 â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  desc_estado_cita     â”‚ VARCHAR(255)         â”‚ Pendiente de Cita          â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de FK)      â”ƒ
â”ƒ                       â”‚                      â”‚ DescripciÃ³n legible        â”ƒ
â”ƒ                       â”‚                                                    â”ƒ
â”ƒ  solicitante_id       â”‚ BIGINT, FK          â”‚ 1                          â”ƒ
â”ƒ                       â”‚ â†’ dim_usuarios      â”‚ (Usuario actual del        â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚  sistema que cargÃ³)        â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  solicitante_nombre   â”‚ VARCHAR(255)        â”‚ Carlos Admin               â”ƒ
â”ƒ                       â”‚                      â”‚ (Auto-obtenido de         â”ƒ
â”ƒ                       â”‚                      â”‚  dim_usuarios.name_user)   â”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ‘¤ GESTOR DE CITAS (Se asigna posteriormente)                             â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  responsable_gestora_idâ”‚ BIGINT, FK          â”‚ NULL (inicialmente)        â”ƒ
â”ƒ                       â”‚ â†’ dim_usuarios      â”‚ Se asigna despuÃ©s          â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚                            â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  fecha_asignacion     â”‚ TIMESTAMP TZ        â”‚ NULL (inicialmente)        â”ƒ
â”ƒ                       â”‚                      â”‚ Se registra al asignar     â”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ â° AUDITORÃA Y CONTROL (Auto-generadas)                                    â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                                                             â”ƒ
â”ƒ  fecha_solicitud      â”‚ TIMESTAMP TZ        â”‚ 2026-01-23 10:30:00        â”ƒ
â”ƒ                       â”‚ NOT NULL            â”‚ (CURRENT_TIMESTAMP)        â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚                            â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  fecha_actualizacion  â”‚ TIMESTAMP TZ        â”‚ 2026-01-23 10:30:00        â”ƒ
â”ƒ                       â”‚ NOT NULL            â”‚ (Auto-actualizado por      â”ƒ
â”ƒ                       â”‚                      â”‚  trigger en cada UPDATE)   â”ƒ
â”ƒ                       â”‚                      â”‚                            â”ƒ
â”ƒ  activo               â”‚ BOOLEAN, NOT NULL   â”‚ true                       â”ƒ
â”ƒ                       â”‚ Default: true       â”‚ false = soft delete        â”ƒ
â”ƒ                       â”‚ Ãndice: SÃ          â”‚                            â”ƒ
â”ƒ                                                                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
```

---

## ğŸ”— RELACIONES DE INTEGRIDAD (8 Foreign Keys - Actualizado v1.6.0)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MATRIZ DE FOREIGN KEYS                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  #   â”‚ De Columna           â”‚ Referencia         â”‚ AcciÃ³n    â”‚ Ãndice       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FK1  â”‚ id_tipo_bolsa        â”‚ dim_tipos_bolsas   â”‚ RESTRICT  â”‚ âœ… SÃ­        â”‚
â”‚      â”‚ (NOT NULL)           â”‚ .id_tipo_bolsa     â”‚           â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FK2  â”‚ id_servicio          â”‚ dim_servicio_essi  â”‚ RESTRICT  â”‚ âœ… SÃ­        â”‚
â”‚      â”‚ (NOT NULL)           â”‚ .id_servicio       â”‚           â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FK3  â”‚ paciente_id          â”‚ asegurados         â”‚ RESTRICT  â”‚ âœ… SÃ­        â”‚
â”‚      â”‚ (NOT NULL)           â”‚ .pk_asegurado      â”‚           â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FK4  â”‚ id_ipress            â”‚ dim_ipress         â”‚ SET NULL  â”‚ âœ… SÃ­        â”‚
â”‚      â”‚ (nullable)           â”‚ .id_ipress         â”‚           â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FK5  â”‚ estado_gestion_citas â”‚ dim_estados_       â”‚ RESTRICT  â”‚ âœ… SÃ­        â”‚ â—„â”€ NUEVO
â”‚      â”‚ _id (NOT NULL)       â”‚ gestion_citas      â”‚           â”‚              â”‚
â”‚      â”‚ Default: 5           â”‚ .id_estado_cita    â”‚           â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FK6  â”‚ solicitante_id       â”‚ dim_usuarios       â”‚ SET NULL  â”‚ âœ… SÃ­        â”‚
â”‚      â”‚ (nullable)           â”‚ .id_user           â”‚           â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FK7  â”‚ responsable_gestora  â”‚ dim_usuarios       â”‚ SET NULL  â”‚ âœ… SÃ­        â”‚
â”‚      â”‚ _id (nullable)       â”‚ .id_user           â”‚           â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ VISUALIZACIÃ“N EN MÃ“DULO DE BOLSAS (Actualizado v1.6.0)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  TABLA: Solicitudes de Bolsa (dim_solicitud_bolsa) v1.6.0                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                            â•‘
â•‘ ID â”‚ Solicitud â”‚ Tipo Bolsaâ”‚Especialidadâ”‚ Paciente     â”‚ DNI      â”‚IPRESS â”‚
â•‘â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ 1  â”‚BOLSA-0001 â”‚BOLSA_107  â”‚CardiologÃ­a â”‚Juan PÃ©rez G. â”‚12345678  â”‚H.II P.â•‘
â•‘ 2  â”‚BOLSA-0002 â”‚BOLSA_107  â”‚CardiologÃ­a â”‚MarÃ­a LÃ³pez M.â”‚87654321  â”‚H.II P.â•‘
â•‘ 3  â”‚BOLSA-0003 â”‚DENGUE     â”‚NeurologÃ­a  â”‚Carlos Ruiz M.â”‚56789012  â”‚H. Ica â•‘
â•‘                                                                            â•‘
â•‘ Red Asistencial â”‚Estado de Cita      â”‚ Solicitante â”‚ Gestor Asignado â”‚   â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â•‘
â•‘ RED UCAYALI     â”‚PENDIENTE_CITA â—„â”€â”€â”€ â”‚ Carlos Ad.  â”‚ (sin asignar)    â”‚ [â‹®] â•‘
â•‘ RED UCAYALI     â”‚PENDIENTE_CITA      â”‚ Carlos Ad.  â”‚ (sin asignar)    â”‚ [â‹®] â•‘
â•‘ RED ICA         â”‚PENDIENTE_CITA      â”‚ Carlos Ad.  â”‚ (sin asignar)    â”‚ [â‹®] â•‘
â•‘                                                                            â•‘
â•‘ EXPLICACIÃ“N:                                                               â•‘
â•‘ â€¢ Columna "Estado de Cita" ahora usa dim_estados_gestion_citas             â•‘
â•‘ â€¢ Valor inicial: PENDIENTE_CITA (id_estado_cita = 5 en dim_...)             â•‘
â•‘ â€¢ Puede cambiar a: CITADO, NO_CONTESTA, CANCELADO, ASISTIO, etc.         â•‘
â•‘ â€¢ El cambio de estado se realiza editando estado_gestion_citas_id          â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## âœ… RESUMEN EJECUTIVO v1.6.0 - CAMBIOS PRINCIPALES

```
âœ… NUEVO CAMPO: estado_gestion_citas_id (FK a dim_estados_gestion_citas)
   â€¢ Tipo: BIGINT, NOT NULL, DEFAULT 5 (PENDIENTE_CITA)
   â€¢ Remplaza el campo "estado" con valores hardcodeados
   â€¢ Ahora usa todos los 10 estados definidos en dim_estados_gestion_citas

âœ… NUEVOS CAMPOS DESNORMALIZADOS:
   â€¢ cod_estado_cita (TEXT): CÃ³digo del estado (ej: PENDIENTE_CITA)
   â€¢ desc_estado_cita (VARCHAR 255): DescripciÃ³n legible (ej: "Pendiente de Cita")

âœ… ESTADO INICIAL:
   â€¢ estado_gestion_citas_id = 5 (buscar en dim_estados_gestion_citas
     donde cod_estado_cita = 'PENDIENTE_CITA')
   â€¢ cod_estado_cita = "PENDIENTE_CITA"
   â€¢ desc_estado_cita = "Pendiente de Cita"

âœ… TABLA ACTUALIZADA:
   â€¢ 26 campos totales (era 25, se agregaron 2: cod_estado_cita, desc_estado_cita)
   â€¢ 8 Foreign Keys (era 7, se agregÃ³ FK5 a dim_estados_gestion_citas)
   â€¢ 9 Ã­ndices para optimizaciÃ³n (sin cambio)
   â€¢ Soft delete con campo activo (sin cambio)
   â€¢ AuditorÃ­a completa de cambios (sin cambio)

âœ… VISUALIZACIÃ“N EN MÃ“DULO:
   Columna "Estado" ahora muestra:
   â€¢ PENDIENTE_CITA (inicial)
   â€¢ CITADO (asignado gestor, cita programada)
   â€¢ NO_CONTESTA (contacto fallido)
   â€¢ CANCELADO (cita cancelada)
   â€¢ ASISTIO (paciente asistiÃ³)
   â€¢ REPROGRAMADO (cita reprogramada)
   â€¢ INASISTENCIA (no asistiÃ³)
   â€¢ VENCIDO (plazo venciÃ³)
   â€¢ EN_SEGUIMIENTO (seguimiento)
   â€¢ DERIVADO (derivada a otro centro)

âœ… ELIMINADO:
   â€¢ Campo "estado" VARCHAR con valores hardcodeados
   â€¢ LÃ³gica interna de cambio de estado

âœ… VENTAJAS v1.6.0:
   â€¢ Estados centralizados en dim_estados_gestion_citas
   â€¢ AuditorÃ­a completa de cambios de estado
   â€¢ FÃ¡cil expansiÃ³n de nuevos estados sin modificar cÃ³digo
   â€¢ Coherencia con mÃ³dulo Estados GestiÃ³n Citas v1.33.0
   â€¢ VisualizaciÃ³n de estado legible y consistente
```

---

## ğŸ“‹ TABLA DE COMPARACIÃ“N: v1.5.0 vs v1.6.0

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CaracterÃ­stica           â”‚ v1.5.0              â”‚ v1.6.0 (NUEVO)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Estado inicial           â”‚ PENDIENTE (hardcode)â”‚ PENDIENTE_CITA (FK)        â”‚
â”‚ Campos de estado         â”‚ 1 (estado)          â”‚ 3 (FK + cÃ³digo + desc)     â”‚
â”‚ Tabla de referencia      â”‚ Ninguna             â”‚ dim_estados_gestion_citas  â”‚
â”‚ Foreign Keys             â”‚ 7                   â”‚ 8                          â”‚
â”‚ Campos totales           â”‚ 25                  â”‚ 26                         â”‚
â”‚ Estados disponibles      â”‚ 4 (hardcode)        â”‚ 10 (de tabla)              â”‚
â”‚ Ampliar estados          â”‚ Cambio de cÃ³digo    â”‚ Insertar en dim_estados... â”‚
â”‚ Coherencia con mÃ³dulos   â”‚ Parcial             â”‚ Total (MÃ³dulo v1.33.0)     â”‚
â”‚ AuditorÃ­a de cambios     â”‚ Parcial             â”‚ Completa (FK + triggers)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ CONSIDERACIONES TÃ‰CNICAS v1.6.0

### A. BÃºsqueda del Estado Inicial

```sql
-- Al insertar, buscar el ID del estado PENDIENTE_CITA:
SELECT id_estado_cita
FROM dim_estados_gestion_citas
WHERE cod_estado_cita = 'PENDIENTE_CITA'
  AND stat_estado_cita = 'A'
LIMIT 1;

-- Esperado: id_estado_cita = 5 (primer estado de los 10 iniciales)
```

### B. Ãndices Necesarios

```sql
-- Ãndice en estado_gestion_citas_id para bÃºsquedas rÃ¡pidas
CREATE INDEX idx_solicitud_bolsa_estado_gestion_citas_id
ON dim_solicitud_bolsa(estado_gestion_citas_id);

-- Ãndice compuesto para reportes
CREATE INDEX idx_solicitud_bolsa_tipo_estado
ON dim_solicitud_bolsa(id_tipo_bolsa, estado_gestion_citas_id);
```

### C. ValidaciÃ³n de Integridad

```sql
-- FK5: Validar que estado_gestion_citas_id siempre es NOT NULL
ALTER TABLE dim_solicitud_bolsa
ADD CONSTRAINT fk_solicitud_estado_gestion_citas
FOREIGN KEY (estado_gestion_citas_id)
REFERENCES dim_estados_gestion_citas(id_estado_cita)
ON UPDATE CASCADE
ON DELETE RESTRICT;  -- RESTRICT porque es NOT NULL
```

### D. Trigger para AuditorÃ­a

```sql
-- Trigger para registrar cambios de estado
CREATE TRIGGER trg_auditoria_cambio_estado
AFTER UPDATE OF estado_gestion_citas_id ON dim_solicitud_bolsa
FOR EACH ROW
BEGIN
    INSERT INTO dim_auditoria_cambios_estado(
        id_solicitud,
        estado_anterior,
        estado_nuevo,
        usuario_id,
        fecha_cambio
    ) VALUES (
        NEW.id_solicitud,
        OLD.estado_gestion_citas_id,
        NEW.estado_gestion_citas_id,
        CURRENT_USER_ID,
        CURRENT_TIMESTAMP
    );
END;
```

---

## âœ… RESUMEN FINAL v1.6.0

**APROBADO PARA IMPLEMENTACIÃ“N:**
- âœ… Estado centralizado en dim_estados_gestion_citas
- âœ… Estado inicial: PENDIENTE_CITA (id = 5)
- âœ… 26 campos en tabla Ãºnica
- âœ… 8 Foreign Keys con integridad garantizada
- âœ… 9 Ã­ndices optimizados
- âœ… AuditorÃ­a completa de cambios
- âœ… Coherencia con mÃ³dulo Estados GestiÃ³n Citas v1.33.0

**VersiÃ³n:** 1.6.0 DEFINITIVO | **Fecha:** 2026-01-23 | **Status:** âœ… LISTO PARA IMPLEMENTACIÃ“N

---

**Â¿ESTE UML v1.6.0 ESTÃ APROBADO PARA PROCEDER CON IMPLEMENTACIÃ“N?**
